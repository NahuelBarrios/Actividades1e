/*
 * array.c
 *
 *  Created on: 16 abr. 2020
 *      Author: Nahu_
 */


#include <stdio.h>
#include <stdlib.h>
#include "array.h"
#include "utn.h"

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
int initColegio(colegioE pArray[],int limite)
{
	int retorno = -1;

	if(pArray != NULL && limite > 0)
	{
		for(; limite > 0; limite--)
		{
			pArray[limite-1].isEmpty = 1;
		}
		retorno=0;
	}
	return retorno;
}

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
int cargarPersona(colegioE array[], int size)
{
    int retorno=-1;
    int posicion;
    if(array!=NULL && size>0)
    {
        if(buscarEmpty(array,size,&posicion)==-1)
        {
            printf("\nNo hay lugares vacios");
        }
        else
        {
        	utn_getUnsignedInt("\nIngrese el legajo: ","\nError.",1,sizeof(int),1,size,3,&array[posicion].legajo);
            utn_getName("Ingrese el sexo (femenino o masculino): ","\n\nError. Intentelo de nuevo",1,51,3,array[posicion].sexo);
            utn_getUnsignedInt("\nIngrese la edad: ","\nError",1,sizeof(int),1,99,3,&array[posicion].edad);
            utn_getUnsignedInt("\nIngrese la nota1P: ","\nError",1,sizeof(int),1,10,3,&array[posicion].nota1P);
            utn_getUnsignedInt("\nIngrese la nota2P: ","\nError",1,sizeof(int),1,10,3,&array[posicion].nota2P);
            utn_getTexto("Ingrese el Apeliido: ","\nError",1,51,1,array[posicion].apellidos);
            array[posicion].promedio= (array[posicion].nota1P + array[posicion].nota2P)/2;
            array[posicion].isEmpty=0;
            retorno=0;
        }
    }
    return retorno;
}


int buscarEmpty(colegioE array[], int size, int* posicion)
{
    int retorno=-1;
    int i;
    if(array!= NULL && size>=0 && posicion!=NULL)
    {
        for(i=0;i<size;i++)
        {
            if(array[i].isEmpty==1)
            {
                retorno=0;
                *posicion=i;
                break;
            }
        }
    }
    return retorno;
}
//-----------------------------------------------------------------------------------------------------------------------------------------------------------

int mostrarUnEstudiante(colegioE array[], int size,int idBuscado)
{
    int retorno=-1;
    int i;
    if(array!=NULL && size>=0 && idBuscado>=0)
    {
        for(i=0;i<size;i++)
        {
            if(array[i].isEmpty==0 && array[i].legajo == idBuscado )
            	 printf("\n Legajo: %d\nSexo: %s\nedad: %d\nnotap1: %d\nnotap2: %d\n apellido: %s\npromedio: %.2f",
            	                       array[i].legajo,array[i].sexo,array[i].edad,array[i].nota1P,array[i].nota2P,array[i].apellidos,array[i].promedio);
            else
                printf("\nEse legajo no existe papu :(.\n");
        }
        retorno=0;
    }
    return retorno;
}

//-----------------------------------------------------------------------------------------------------------------------------------------------------------

int mostrarEstudiantes(colegioE array[], int size)
{
    int retorno=-1;
    int i;
    if(array!=NULL && size>=0)
    {
    	for(i=0;i<size;i++)
    	{
    		if(array[i].isEmpty==1)
    			continue;
    		else
    			printf("\n Legajo: %d\nSexo: %s\nedad: %d\nnotap1: %d\nnotap2: %d\n apellido: %s\npromedio: %.2f",
    			            	                       array[i].legajo,array[i].sexo,array[i].edad,array[i].nota1P,array[i].nota2P,array[i].apellidos,array[i].promedio);
        }
        retorno=0;
    }
    return retorno;
}

//-----------------------------------------------------------------------------------------------------------------------------------------------------------
int estructuraOrdenada(colegioE array[], int size,colegioE arrayAux[])
{
	 int retorno=-1;
	    int i, j;
	    char bufferApellido[51];
	    int bufferLegajo;
	    char bufferSexo[51];
	   	int bufferedad;
	   	int buffernota1P;
	   	int buffernota2P;
	    float bufferpromedio;
	    int bufferIsEmpty;

	    if(array!=NULL && size>=0)
	    {
	        for (i = 1; i < size; i++)
	        {
	            strcpy(bufferApellido,array[i].apellidos);
	            bufferLegajo=array[i].legajo;
	            strcpy(bufferSexo,array[i].sexo);
	            bufferIsEmpty=array[i].isEmpty;
	            bufferInt=array[i].varInt;                                //cambiar campo varInt
	            bufferFloat=array[i].varFloat;                            //cambiar campo varFloat
	            strcpy(bufferLongString,array[i].varLongString);          //cambiar campo varLongString
	            bufferIsEmpty=array[i].isEmpty;

	            j = i - 1;
	            while ((j >= 0) && strcmp(bufferString,array[j].varString)<0)         //cambiar campo varString                 //Si tiene mas de un criterio se lo agrego, Ej. bufferInt<array[j].varInt
	            {                                                                                                               //buffer < campo ascendente   buffer > campo descendente
	                strcpy(array[j + 1].varString,array[j].varString);          //cambiar campo varString
	                array[j + 1].idUnico=array[j].idUnico;                                //cambiar campo id
	                array[j + 1].isEmpty=array[j].isEmpty;

	                array[j + 1].varInt=array[j].varInt;                        //cambiar campo varInt
	                array[j + 1].varFloat=array[j].varFloat;                    //cambiar campo varFloat
	                strcpy(array[j + 1].varLongString,array[j].varLongString);  //cambiar campo varLongString

	                j--;
	            }
	            strcpy(array[j + 1].varString,bufferString);                     //cambiar campo varString
	            array[j + 1].idUnico=bufferId;                                        //cambiar campo id
	            array[j + 1].isEmpty=bufferIsEmpty;

	            array[j + 1].varInt=bufferInt;                                                        //cambiar campo varInt
	            array[j + 1].varFloat=bufferFloat;                                                    //cambiar campo varFloat
	            strcpy(array[j + 1].varLongString,bufferLongString);                                  //cambiar campo varLongString
	        }
	        retorno=0;
	    }
	    return retorno;
}

//-----------------------------------------------------------------------------------------------------------------------------------------------------------

